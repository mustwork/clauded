---
# Install base Python tools for system compatibility
# The uv role will install the specific Python version requested by the user

- name: Install Python build dependencies
  apt:
    name:
      - python3
      - python3-dev
      - python3-pip
      - python3-venv
      # Build dependencies for compiling Python from source
      - build-essential
      - libffi-dev
      - libssl-dev
      - zlib1g-dev
      - libreadline-dev
      - libbz2-dev
      - liblzma-dev
      - libsqlite3-dev
      - libncurses5-dev
      - libncursesw5-dev
    state: present
    update_cache: yes

- name: Install pipx via pip
  pip:
    name: pipx
    executable: pip3
    extra_args: --break-system-packages

- name: Ensure pipx path is configured
  shell: pipx ensurepath
  changed_when: false
  ignore_errors: yes

- name: Display system Python version
  command: python3 --version
  register: system_python_output
  changed_when: false

- name: Note system Python
  debug:
    msg: "System Python: {{ system_python_output.stdout }} (uv will install Python {{ python_version }})"
