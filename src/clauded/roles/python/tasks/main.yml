---
- name: Install Python and tools
  apk:
    name:
      - python3
      - python3-dev
      - py3-pip
      - py3-virtualenv
    state: present
    update_cache: yes

- name: Create python3 symlink
  file:
    src: /usr/bin/python3
    dest: /usr/bin/python
    state: link
    force: yes

- name: Install pipx via pip
  pip:
    name: pipx
    executable: pip3
    extra_args: --break-system-packages

- name: Ensure pipx path is configured
  shell: pipx ensurepath
  changed_when: false
  ignore_errors: yes

- name: Verify Python installation
  command: python3 --version
  register: python_version_output
  changed_when: false

- name: Display Python version
  debug:
    msg: "Python version: {{ python_version_output.stdout }}"
